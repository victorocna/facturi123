(function($){$.fn.autoNumeric=function(){return this.each(function(){var d=$.extend($.fn.autoNumeric.defaults);var p=$(this);var q=this.id;$(this).keypress(function(e){$.extend(d,autoCode(q,d));var a=0;var b=0;var c=0;var f=0;var g=d.aNum+d.aSign+d.aDec;if(document.selection){this.focus();var h=document.selection.createRange();var i=document.selection.createRange().text.length;h.moveStart('character',-this.value.length);a=(h.text.length-i)*1;f=this.value.length*1}else if(this.selectionStart||this.selectionStart=='0'){a=this.selectionStart*1;f=this.value.length*1}b=f-(f-this.value.lastIndexOf(d.aDec));if(b==-1){b=f}c=(f-this.value.lastIndexOf(d.aDec))-1;if(this.value.lastIndexOf(d.aDec)==-1){c=0}if(!e){e=window.event}var k='';if(e.keyCode){k=e.keyCode}else if(e.which){k=e.which}var l=String.fromCharCode(k);if((e.ctrlKey)&&(l=='c'||l=='v'||l=='x'||e.which==67||e.which==86||e.which==88)){return}if(k==8||e.keyCode==37||(e.keyCode==39||e.which===0)){return}if(g.indexOf(l)==-1){if(d.aDec!='.'&&d.aSep!='.'&&e.which===0){return}else{e.preventDefault()}}var m=this.value;var n='';var o=0;for(j=0;j<b;j++){n=m.charAt(j);if(n>='0'&&n<='9'){o++}}if(l==d.aDec){if(e.which===0){return}else if(this.value.indexOf(d.aDec)!=-1||d.mDec<=0||a<this.value.length-d.mDec||a===0&&this.value.charAt(0)=='-'||this.value.lastIndexOf(d.aSep)>=a&&d.aSep!==''){e.preventDefault()}}if(k==45&&(a>0||this.value.indexOf('-')!=-1||d.aSign==='')){e.preventDefault()}if(k>=48&&k<=57){if(this.value.indexOf('-')!=-1){if(a===0){e.preventDefault()}if(this.value.charAt(1)==='0'&&this.value.length>=2&&(a==1&&k==48||a>=2&&a<=b)){e.preventDefault()}if((this.value.charAt(1)>=1&&this.value.charAt(1)<=9)&&(a==1&&k==48)){e.preventDefault()}}if(this.value.indexOf('-')==-1&&this.value.length>0){if(this.value.charAt(0)==='0'&&a>0&&a<=b){e.preventDefault()}if(b>0&&a===0&&k==48){e.preventDefault()}}if(o>=d.mNum&&a<=b){e.preventDefault()}if(this.value.indexOf(d.aDec)!=-1&&a>=(this.value.length-c)&&c>=d.mDec){e.preventDefault()}}});$(this).keyup(function(e){if(e.keyCode==37||e.keyCode==39||d.aSep===''){return}document.getElementById(this.id).value=autoGroup(this.value,d)});$(this).change(function(){if($.browser.opera){autoCheck(p,q,d)}});$(this).bind('paste',function(){setTimeout(function(){autoCheck(p,q,d)},0)})})};$.fn.autoNumeric.defaults={aNum:'0123456789',aSign:'',aSep:',',aDec:'.',mNum:9,mDec:2,dGroup:/(\d)((\d{3}?)+)$/,rMethod:'S'};function autoCode(a,d){var b=$('#'+a).attr('alt');if(b!==''){d.aSign=(b.charAt(0)==='n')?'-':'';d.mNum=(b.charAt(1)==='0')?d.mNum=15:b.charAt(1)*1;if(b.charAt(2)!='c'){if(b.charAt(2)==='a'){d.aSep='\''}else if(b.charAt(2)==='p'){d.aSep='.'}else if(b.charAt(2)==='s'){d.aSep=' '}else{d.aSep=''}}if(b.charAt(3)!=3){d.dGroup=(b.charAt(3)==2)?/(\d)((\d)(\d{2}?)+)$/:/(\d)((\d{4}?)+)$/}d.aDec=(b.charAt(4)==='c')?',':d.aDec;d.mDec=(b.charAt(5)<='9')?b.charAt(5)*1:document.getElementById('dp'+b.charAt(5)).value*1;d.rMethod=(b.charAt(6)!=='')?b.charAt(6):d.rMethod}return d}function autoGroup(a,d){a=a.split(d.aSep).join('');var b=a.split(d.aDec);var s=b[0];while(d.dGroup.test(s)){s=s.replace(d.dGroup,'$1'+d.aSep+'$2')}if(d.mDec!==0&&b.length>1){a=s+d.aDec+b[1]}else{a=s}return a}function autoRound(a,b,c){var d='';var i=0;var e='';a=a+'';if(a.charAt(0)=='-'){e=(a*1===0)?'':'-';a=a.replace('-','')}var f=a.lastIndexOf('.');if(f===0){a='0'+a;f=1}if(f==-1||f==a.length-1){if(b>0){d=(f==-1)?a+'.':a;for(i=0;i<b;i++){d+='0'}return e+d}else{return e+a}}var g=(a.length-1)-f;if(g==b){return e+a}if(g<b){d=a;for(i=g;i<b;i++){d+='0'}return e+d}var h=f+b;var j=a.charAt(h+1)*1;var k=[];for(i=0;i<=h;i++){k[i]=a.charAt(i)}var l=(a.charAt(h)=='.')?(a.charAt(h-1)%2):(a.charAt(h)%2);if((j>4&&c==='S')||(j>4&&c==='A'&&e==='')||(j>5&&c==='A'&&e=='-')||(j>5&&c==='s')||(j>5&&c==='a'&&e==='')||(j>4&&c==='a'&&e=='-')||(j>5&&c==='B')||(j==5&&c==='B'&&l==1)||(j>0&&c==='C'&&e==='')||(j>0&&c==='F'&&e=='-')||(j>0&&c==='U')){for(i=(k.length-1);i>=0;i--){if(k[i]=='.'){continue}k[i]++;if(k[i]<10){break}}}for(i=0;i<=h;i++){if(k[i]=='.'||k[i]<10||i===0){d+=k[i]}else{d+='0'}}if(b===0){d=d.replace('.','')}return e+d}function autoCheck(a,b,d){var c=a.val();if(c.length>25){document.getElementById(b).value='';return}$.extend(d,autoCode(b,d));var e=d.aNum+d.aSign+d.aDec;var f='';if(d.aSign=='-'){f='\\-'}var g=new RegExp('[^'+f+d.aNum+d.aDec+']','gi');var h=c.replace(g,'');if(h.lastIndexOf('-')>0||h.indexOf(d.aDec)!=h.lastIndexOf(d.aDec)){h=''}var j='';var k=0;var l='';var i=0;var s=h.split('');for(i=0;i<s.length;i++){if(i===0&&s[i]=='-'){k=1;l='-';continue}if(s[i]==d.aDec&&s.length-1==i){break}if(j.length===0&&s[i]=='0'&&(s[i+1]>=0||s[i+1]<=9)){continue}else{j=j+s[i]}}j=l+j;if(j.indexOf(d.aDec)==-1&&j.length>(d.mNum+k)){j=''}if(j.indexOf(d.aDec)>(d.mNum+k)){j=''}if(j.indexOf(d.aDec)!=-1&&(d.aDec!='.')){j=j.replace(d.aDec,'.')}j=autoRound(j,d.mDec,d.rMethod);if(d.aDec!='.'){j=j.replace('.',d.aDec)}if(j!==''&&d.aSep!==''){j=autoGroup(j,d)}document.getElementById(b).value=j}$.fn.autoNumeric.Strip=function(a){var b=document.getElementById(a).value;var d=$.extend($.fn.autoNumeric.defaults);$.extend(d,autoCode(a,d));var c='';if(d.aSign=='-'){c='\\-'}var e=new RegExp('[^'+c+d.aNum+d.aDec+']','gi');b=b.replace(e,'');if(b.indexOf(d.aDec)!=-1&&(d.aDec!='.')){b=b.replace(d.aDec,'.')}if(b*1===0&&c!==''){b=b.replace('-','')}return b};$.fn.autoNumeric.Format=function(a,b){var d=$.extend($.fn.autoNumeric.defaults);$.extend(d,autoCode(a,d));b=autoRound(b,d.mDec,d.rMethod);var c=0;if(b.indexOf('-')!=-1&&d.aSign===''){b=''}else if(b.indexOf('-')!=-1&&d.aSign=='-'){c=1}if(b.indexOf('.')==-1&&b.length>(d.mNum+c)){b=''}else if(b.indexOf('.')>(d.mNum+c)){b=''}if(d.aDec!='.'){b=b.replace('.',d.aDec)}return autoGroup(b,d)}})(jQuery);