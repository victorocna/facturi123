jQuery.fn.pagination=function(m,n){n=jQuery.extend({items_per_page:10,num_display_entries:10,current_page:0,num_edge_entries:0,link_to:"#",prev_text:"Prev",next_text:"Next",ellipse_text:"...",prev_show_always:true,next_show_always:true,callback:function(){return false}},n||{});return this.each(function(){function numPages(){return Math.ceil(m/n.items_per_page)}function getInterval(){var a=Math.ceil(n.num_display_entries/2);var b=numPages();var c=b-n.num_display_entries;var d=k>a?Math.max(Math.min(k-a,c),0):0;var e=k>a?Math.min(k+a,b):Math.min(n.num_display_entries,b);return[d,e]}function pageSelected(a,b){k=a;drawLinks();var c=n.callback(a,l);if(!c){if(b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}}return c}function drawLinks(){l.empty();var d=getInterval();var e=numPages();var f=function(b){return function(a){return pageSelected(b,a)}};var g=function(a,b){a=a<0?0:(a<e?a:e-1);b=jQuery.extend({text:a+1,classes:""},b||{});if(a==k){var c=jQuery("<span class='current'>"+(b.text)+"</span>")}else{var c=jQuery("<a>"+(b.text)+"</a>").bind("click",f(a)).attr('href',n.link_to.replace(/__id__/,a))}if(b.classes){c.addClass(b.classes)}l.append(c)};if(n.prev_text&&(k>0||n.prev_show_always)){g(k-1,{text:n.prev_text,classes:"prev"})}if(d[0]>0&&n.num_edge_entries>0){var h=Math.min(n.num_edge_entries,d[0]);for(var i=0;i<h;i++){g(i)}if(n.num_edge_entries<d[0]&&n.ellipse_text){jQuery("<span>"+n.ellipse_text+"</span>").appendTo(l)}}for(var i=d[0];i<d[1];i++){g(i)}if(d[1]<e&&n.num_edge_entries>0){if(e-n.num_edge_entries>d[1]&&n.ellipse_text){jQuery("<span>"+n.ellipse_text+"</span>").appendTo(l)}var j=Math.max(e-n.num_edge_entries,d[1]);for(var i=j;i<e;i++){g(i)}}if(n.next_text&&(k<e-1||n.next_show_always)){g(k+1,{text:n.next_text,classes:"next"})}}var k=n.current_page;m=(!m||m<0)?1:m;n.items_per_page=(!n.items_per_page||n.items_per_page<0)?1:n.items_per_page;var l=jQuery(this);this.selectPage=function(a){pageSelected(a)};this.prevPage=function(){if(k>0){pageSelected(k-1);return true}else{return false}};this.nextPage=function(){if(k<numPages()-1){pageSelected(k+1);return true}else{return false}};drawLinks()})};